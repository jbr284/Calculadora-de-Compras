/* =========================================
   1. RESET E BASE
   ========================================= */
* { box-sizing: border-box; margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; }
body { background-color: #f4f4f9; color: #333; padding-bottom: 90px; height: 100vh; overflow-y: auto; }

/* Cabeçalho */
header { background-color: #007bff; color: white; padding: 15px; text-align: center; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); position: sticky; top: 0; z-index: 900; }
header h1 { font-size: 20px; font-weight: 600; }

/* Layout Views */
main { padding: 15px; max-width: 600px; margin: 0 auto; height: calc(100vh - 60px); }
.view { display: none; animation: fadeIn 0.3s ease; }
.view.active { display: block; }

/* Calculadora Fixa */
#interface-geral { display: flex; flex-direction: column; height: calc(100vh - 160px); overflow: hidden; }
.hidden { display: none !important; }
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

/* Inputs e Botões */
input, select, button { width: 100%; padding: 12px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; outline: none; }
input:focus, select:focus { border-color: #007bff; }
button { background-color: #007bff; color: white; border: none; font-weight: bold; cursor: pointer; transition: background 0.2s; }
button:active { transform: scale(0.98); }
.btn-success { background-color: #28a745; }
.btn-danger { background-color: #dc3545; }
.row { display: flex; gap: 10px; }
.row input { flex: 2; }
.row select { flex: 1; }

/* Cards de Lista */
.cards-container { display: flex; flex-direction: column; gap: 12px; padding-bottom: 20px; }
.card-lista { background: white; padding: 15px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05); border-left: 5px solid #007bff; display: flex; justify-content: space-between; align-items: center; }
.card-info { flex: 1; }
.card-info h3 { font-size: 18px; margin-bottom: 5px; color: #333; }
.card-info span { font-size: 12px; color: #666; }

/* Botões de Ação Card */
.card-actions { display: flex; gap: 8px; }
.btn-card { width: 38px; height: 38px; border-radius: 8px; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 16px; color: white; margin: 0; padding: 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
.btn-card.use { background-color: #28a745; }
.btn-card.edit { background-color: #ffc107; color: #333; }
.btn-card.del { background-color: #dc3545; }
.empty-msg { text-align: center; margin-top: 40px; color: #777; font-size: 16px; line-height: 1.5; }

/* FAB */
.fab { position: fixed; bottom: 90px; right: 20px; width: 60px; height: 60px; border-radius: 50%; font-size: 30px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3); z-index: 100; display: flex; align-items: center; justify-content: center; padding: 0; background-color: #007bff; }

/* Calculadora Geral (Fixa) */
.top-bar-fixed { flex-shrink: 0; }
.calc-total-box { background: #333; color: #fff; padding: 20px; border-radius: 10px; text-align: center; margin-bottom: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); flex-shrink: 0; z-index: 10; }
.calc-total-label { font-size: 14px; color: #ccc; text-transform: uppercase; letter-spacing: 1px; }
.calc-total-value { font-size: 42px; font-weight: bold; color: #28a745; font-family: monospace; }

.tape-container { background: white; border: 1px solid #ddd; border-radius: 8px; flex-grow: 1; overflow-y: auto; padding: 10px; margin-bottom: 10px; box-shadow: inset 0 2px 5px rgba(0,0,0,0.05); }
.tape-list { list-style: none; display: flex; flex-direction: column; justify-content: flex-end; min-height: 100%; }
.tape-item { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px dashed #eee; font-size: 18px; font-family: monospace; }
.tape-item:last-child { border-bottom: none; font-weight: bold; background-color: #f9f9f9; }
.tape-op { color: #007bff; font-weight: bold; margin-right: 10px; }

.calc-controls-area { flex-shrink: 0; background-color: #f4f4f9; padding-top: 5px; z-index: 10; }
.calc-input-row { display: flex; gap: 10px; margin-bottom: 10px; }
.input-calc-big { font-size: 24px; padding: 15px; text-align: right; font-weight: bold; border: 2px solid #007bff; border-radius: 8px; height: 60px; }
.btn-calc-action { height: 60px; font-size: 28px; font-weight: bold; border-radius: 8px; flex: 1; display: flex; align-items: center; justify-content: center; padding: 0; }
.btn-op-add { background-color: #28a745; color: white; }
.btn-op-sub { background-color: #dc3545; color: white; }
.btn-op-mul { background-color: #ffc107; color: #333; }
.btn-op-div { background-color: #17a2b8; color: white; }
.btn-op-clear { background-color: #6c757d; color: white; margin-top: 10px; }

/* === CONFIGURAÇÃO DE TABELA "FIT TO SCREEN" (SEM SCROLL) === */

/* Container geral sem rolagem horizontal */
.tabela-scroll-container {
    width: 100%;
    overflow: hidden; /* Corta o que sobrar, não rola */
    border: 1px solid #eee;
    border-radius: 8px;
    margin-bottom: 15px;
    background: white;
}

#lista-itens-detalhada { 
    width: 100%; 
}

/* Configuração do Grid de Colunas */
.tabela-header, .item-tabela {
    display: grid;
    /* Grid "minmax(0, Xfr)" força o navegador a encolher a coluna se o texto for grande.
       Proporção: Produto(30%) Marca(20%) Qtd(10%) Preço(15%) Total(20%) Del(5%)
    */
    grid-template-columns: minmax(0, 3fr) minmax(0, 2fr) minmax(0, 1.2fr) minmax(0, 1.5fr) minmax(0, 2fr) 25px; 
    gap: 2px;
    align-items: center;
    padding: 10px 4px;
    width: 100%;
}

.tabela-header {
    background-color: #0099ff;
    color: white;
    font-weight: bold;
    text-transform: uppercase;
    font-size: 11px;
    border-radius: 8px 8px 0 0;
    text-align: center;
    letter-spacing: 0.5px;
}

.item-tabela {
    border-bottom: 1px solid #eee;
    font-size: 13px;
    text-align: center;
}
.item-tabela:nth-child(even) { background-color: #f9f9f9; }

/* TRUNCA O TEXTO: Adiciona "..." se não couber */
.item-tabela div { 
    overflow: hidden; 
    text-overflow: ellipsis; 
    white-space: nowrap; 
}

.col-texto { text-align: left; padding-left: 2px; }
.col-num { text-align: center; }
.btn-mini-del { background: none; border: none; cursor: pointer; color: #dc3545; font-size: 14px; padding: 0; display: flex; justify-content: center; }

/* === AJUSTES EXTREMOS PARA CELULAR (Tela < 480px) === */
@media (max-width: 480px) {
    .tabela-header {
        font-size: 9px; /* Fonte do cabeçalho bem pequena */
        padding: 8px 2px;
        letter-spacing: 0;
    }

    .item-tabela {
        font-size: 11px; /* Fonte dos dados pequena */
        padding: 8px 2px;
    }
    
    /* Reajuste de colunas para mobile vertical */
    .tabela-header, .item-tabela {
        /* Diminui a marca, prioriza Produto e Total */
        grid-template-columns: minmax(0, 2.5fr) minmax(0, 1.5fr) minmax(0, 1.2fr) minmax(0, 1.5fr) minmax(0, 1.8fr) 20px;
        gap: 2px;
    }
}

/* Modo Checklist (Importar) */
.item-compra { background: white; padding: 12px; margin-bottom: 10px; border-radius: 8px; border: 1px solid #eee; display: flex; flex-direction: column; gap: 8px; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05); }
.item-compra.item-ativo { border-left: 5px solid #ccc; }
.item-compra.item-confirmado { border-left: 5px solid #28a745; background-color: #f0fff4; }

.checklist-header { display: flex; gap: 10px; align-items: center; margin-bottom: 5px; }
.input-marca-inline { border: none; border-bottom: 1px dashed #ccc; padding: 2px; width: 100%; font-size: 14px; background: transparent; }

.checklist-controls { display: grid; grid-template-columns: 1.2fr 1fr 0.2fr 1.2fr 1fr 0.8fr; gap: 6px; align-items: center; }
.input-compact { padding: 8px 4px !important; margin: 0 !important; font-size: 14px; text-align: center; height: 38px; }
.select-compact { padding: 0 2px !important; margin: 0 !important; font-size: 13px; background-color: #f9f9f9; text-align: center; height: 38px; }
.btn-confirmar { background: #28a745; color: white; border-radius: 6px; font-size: 18px; padding: 0 !important; margin: 0 !important; height: 38px; display: flex; align-items: center; justify-content: center; }
.btn-confirmar.desfazer { background: #ffc107; color: #333; }

@media (max-width: 400px) {
    .checklist-controls { grid-template-columns: 1fr 1fr; row-gap: 8px; }
    .checklist-controls .separator { display: none; }
    .btn-confirmar { grid-column: span 2; }
}

/* Navegação Flutuante */
.bottom-nav { position: fixed; bottom: 0; left: 0; width: 100%; background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(5px); display: flex; gap: 15px; padding: 10px 20px; box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1); z-index: 1000; height: auto; border-top: none; }
.nav-btn { background-color: #f1f3f5; color: #6c757d; border-radius: 12px; margin: 0; display: flex; flex-direction: row; align-items: center; justify-content: center; font-size: 14px; font-weight: 600; flex: 1; border: none; padding: 12px; gap: 8px; transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1); box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
.nav-btn.active { background-color: #007bff; color: white; border-top: none; box-shadow: 0 4px 12px rgba(0, 123, 255, 0.4); transform: translateY(-2px); }
.nav-btn i, .nav-btn span { pointer-events: none; }

/* Modais e Extras */
.calc-options { display: flex; flex-direction: column; gap: 15px; text-align: center; }
.btn-option { padding: 20px; font-size: 18px; background: white; color: #007bff; border: 2px solid #007bff; }
.modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.6); display: flex; align-items: center; justify-content: center; z-index: 2000; }
.modal-content { background: white; padding: 20px; width: 90%; max-width: 400px; border-radius: 12px; max-height: 80vh; overflow-y: auto; }
.item-importar { padding: 15px; border-bottom: 1px solid #eee; cursor: pointer; }
.top-bar { display: flex; gap: 10px; margin-bottom: 15px; }
.btn-back { background: #6c757d; width: auto; margin-bottom: 0; }
.total-bar { background: #333; color: white; padding: 15px; border-radius: 8px; text-align: right; font-size: 20px; margin: 15px 0; font-weight: bold; }
.actions-bar { display: flex; gap: 10px; margin-top: 20px; }
.message { position: fixed; top: 70px; left: 50%; transform: translateX(-50%); background: #28a745; color: white; padding: 10px 20px; border-radius: 20px; font-weight: bold; z-index: 2000; box-shadow: 0 4px 10px rgba(0,0,0,0.2); text-align: center; width: 90%; max-width: 400px; }
